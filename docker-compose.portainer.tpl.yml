version: "3.9"
services:
  backend:
    image: docker.io/emodtibor/oc-soccer-backend@__BACKEND_DIGEST__
    volumes:
      - /srv/oc-soccer/backend/data:/app/data
    restart: unless-stopped
    networks:
      - proxy_shared

  frontend:
    image: docker.io/emodtibor/oc-soccer-frontend@__FRONTEND_DIGEST__
    depends_on:
      - backend
    restart: unless-stopped
    networks:
      - proxy_shared

  sqlite-backup:
    build:
      context: /srv/oc-soccer/ops/sqlite-backup
    container_name: oc-soccer-sqlite-backup
    restart: unless-stopped
    environment:
      TZ: Europe/Budapest
      DB_PATH: /db/db.sqlite
      BACKUP_DIR: /backups
      RETENTION_DAYS: "14"
    volumes:
      - /srv/oc-soccer/backend/data:/db:ro
      - /srv/oc-soccer/backups/sqlite:/backups

networks:
  proxy_shared:
    external: true
